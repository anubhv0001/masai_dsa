<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Advanced Task Manager</title>
    <style>
      :root{
        --container-bg: #ffffff;
        --page-bg: #f3f6fb;
        --primary: #2563eb;
        --success: #10b981;
        --danger: #ef4444;
        --high-highlight: #fff0f0;
        --muted: #6b7280;
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      }

      html,body{
        height:100%;
        margin:0;
        background:var(--page-bg);
        color:#111827;
      }

      .wrap{
        max-width:900px;
        margin:36px auto;
        padding:22px;
      }

      .card{
        background:var(--container-bg);
        border-radius:12px;
        padding:20px;
        box-shadow:0 6px 18px rgba(15,23,42,0.06);
      }

      h1{color:var(--primary);margin:0 0 18px 0}

      .controls{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:16px}
      .controls input[type="text"]{flex:1;padding:10px;border:1px solid #e6eef8;border-radius:8px;min-width:200px}
      .controls select{padding:10px;border-radius:8px;border:1px solid #e6eef8}
      .btn{padding:10px 14px;border-radius:8px;border:none;cursor:pointer}
      .btn.primary{background:var(--primary);color:white}
      .btn.ghost{background:transparent;border:1px solid #e6eef8}

      .filters{display:flex;gap:12px;align-items:center;margin-bottom:18px}
      .filters label{font-size:14px;color:var(--muted);display:flex;gap:8px;align-items:center}

      ul.task-list{list-style:none;padding:0;margin:0}
      li.task{
        display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:8px;border:1px solid #eef2ff;margin-bottom:10px;background:#fbfdff
      }
      li.task.high{background:var(--high-highlight);border-color:#ffd6d6}
      .task .left{display:flex;gap:12px;align-items:center;min-width:0}
      .task .title{font-weight:600;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
      .task .meta{font-size:13px;color:var(--muted)}
      .task.completed .title{text-decoration:line-through;opacity:0.7}

      .task .actions{display:flex;gap:8px}
      .small-btn{padding:6px 9px;border-radius:6px;border:none;cursor:pointer;font-size:13px}
      .small-btn.complete{background:var(--success);color:white}
      .small-btn.undo{background:#f3f4f6}
      .small-btn.delete{background:var(--danger);color:white}
      .priority-select{padding:6px;border-radius:6px;border:1px solid #e6eef8}

      .empty{padding:18px;text-align:center;color:var(--muted)}

      @media (max-width:640px){
        .controls{flex-direction:column}
        .filters{flex-direction:column;align-items:flex-start}
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card" id="root"></div>
    </div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useState } = React;

      function App(){
        const [tasks, setTasks] = useState([]);
        const [title, setTitle] = useState('');
        const [newPriority, setNewPriority] = useState('Medium');
        const [filterPriority, setFilterPriority] = useState('All');
        const [filterStatus, setFilterStatus] = useState('All');

        const priorityOrder = { High: 3, Medium: 2, Low: 1 };

        const sortByPriority = (arr) => {
          return [...arr].sort((a,b) => priorityOrder[b.priority] - priorityOrder[a.priority]);
        };

        const addTask = () => {
          const trimmed = title.trim();
          if(!trimmed) return;

          const newTask = {
            id: Date.now() + Math.random(),
            title: trimmed,
            priority: newPriority,
            completed: false,
          };

          setTasks(prev => sortByPriority([...prev, newTask]));
          setTitle('');
          setNewPriority('Medium');
        };

        const toggleComplete = (id) => {
          setTasks(prev => sortByPriority(prev.map(t => t.id === id ? { ...t, completed: !t.completed } : t)));
        };

        const deleteTask = (id) => {
          setTasks(prev => prev.filter(t => t.id !== id));
        };

        const updatePriority = (id, priority) => {
          setTasks(prev => sortByPriority(prev.map(t => t.id === id ? { ...t, priority } : t)));
        };

        const filtered = tasks.filter(t => {
          const pMatch = filterPriority === 'All' || t.priority === filterPriority;
          const sMatch = filterStatus === 'All' || (filterStatus === 'Completed' && t.completed) || (filterStatus === 'Incomplete' && !t.completed);
          return pMatch && sMatch;
        });

        return (
          <div>
            <h1>Advanced Task Manager</h1>

            <div className="controls">
              <input
                type="text"
                placeholder="Task title..."
                value={title}
                onChange={e => setTitle(e.target.value)}
                onKeyDown={e => e.key === 'Enter' && addTask()}
              />

              <select value={newPriority} onChange={e => setNewPriority(e.target.value)}>
                <option>High</option>
                <option>Medium</option>
                <option>Low</option>
              </select>

              <button className="btn primary" onClick={addTask}>Add Task</button>

              <button className="btn ghost" onClick={() => { setTasks([]); }}>Clear All</button>
            </div>

            <div className="filters">
              <label>
                Priority:
                <select value={filterPriority} onChange={e => setFilterPriority(e.target.value)}>
                  <option>All</option>
                  <option>High</option>
                  <option>Medium</option>
                  <option>Loww</option>
                </select>
              </label>

              <label>
                Status:
                <select value={filterStatus} onChange={e => setFilterStatus(e.target.value)}>
                  <option>All</option>
                  <option>Completed</option>
                  <option>Incomplete</option>
                </select>
              </label>

              <div style={{marginLeft:'auto', color:'#6b7280',fontSize:13}}>{tasks.length} total</div>
            </div>

            <ul className="task-list">
              {filtered.length === 0 ? (
                <div className="empty">No tasks match the current filters.</div>
              ) : (
                filtered.map(task => (
                  <li key={task.id} className={`task ${task.priority === 'High' ? 'high' : ''} ${task.completed ? 'completed' : ''}`}>
                    <div className="left">
                      <input type="checkbox" checked={task.completed} onChange={() => toggleComplete(task.id)} />

                      <div style={{minWidth:0}}>
                        <div className="title">{task.title}</div>
                        <div className="meta">Priority: <strong>{task.priority}</strong></div>
                      </div>
                    </div>

                    <div className="actions">
                      <select className="priority-select" value={task.priority} onChange={e => updatePriority(task.id, e.target.value)}>
                        <option>High</option>
                        <option>Medium</option>
                        <option>Low</option>
                      </select>

                      <button className={`small-btn ${task.completed ? 'undo' : 'complete'}`} onClick={() => toggleComplete(task.id)}>
                        {task.completed ? 'Undo' : 'Complete'}
                      </button>

                      <button className="small-btn delete" onClick={() => deleteTask(task.id)}>Delete</button>
                    </div>
                  </li>
                ))
              )}
            </ul>

          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
